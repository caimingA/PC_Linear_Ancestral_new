2025-06-06 13:14:27,351 INFO - helpers.log_helper - Finished configuring logger.
2025-06-06 13:14:27,371 WARNING - tensorflow - From C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\framework\op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2025-06-06 13:14:27,701 WARNING - tensorflow - From C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\ops\math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2025-06-06 13:14:28,417 INFO - models.gae - Model summary:
2025-06-06 13:14:28,417 INFO - models.gae - ---------
2025-06-06 13:14:28,417 INFO - models.gae - Variables: name (type shape) [size]
2025-06-06 13:14:28,417 INFO - models.gae - ---------
2025-06-06 13:14:28,417 INFO - models.gae - Variable:0 (float64_ref 10x10) [100, bytes: 800]
2025-06-06 13:14:28,417 INFO - models.gae - dense/kernel:0 (float64 1x16) [16, bytes: 128]
2025-06-06 13:14:28,417 INFO - models.gae - dense/bias:0 (float64 16) [16, bytes: 128]
2025-06-06 13:14:28,420 INFO - models.gae - dense_1/kernel:0 (float64 16x16) [256, bytes: 2048]
2025-06-06 13:14:28,420 INFO - models.gae - dense_1/bias:0 (float64 16) [16, bytes: 128]
2025-06-06 13:14:28,420 INFO - models.gae - dense_2/kernel:0 (float64 16x0) [0, bytes: 0]
2025-06-06 13:14:28,420 INFO - models.gae - dense_2/bias:0 (float64 0) [0, bytes: 0]
2025-06-06 13:14:28,420 INFO - models.gae - dense_3/kernel:0 (float64 0x16) [0, bytes: 0]
2025-06-06 13:14:28,421 INFO - models.gae - dense_3/bias:0 (float64 16) [16, bytes: 128]
2025-06-06 13:14:28,421 INFO - models.gae - dense_4/kernel:0 (float64 16x16) [256, bytes: 2048]
2025-06-06 13:14:28,421 INFO - models.gae - dense_4/bias:0 (float64 16) [16, bytes: 128]
2025-06-06 13:14:28,421 INFO - models.gae - dense_5/kernel:0 (float64 16x1) [16, bytes: 128]
2025-06-06 13:14:28,422 INFO - models.gae - dense_5/bias:0 (float64 1) [1, bytes: 8]
2025-06-06 13:14:28,422 INFO - models.gae - Total size of variables: 709
2025-06-06 13:14:28,422 INFO - models.gae - Total bytes of variables: 5672
2025-06-06 13:14:28,493 INFO - trainers.al_trainer - Started training for 20 iterations
2025-06-06 13:14:28,494 INFO - trainers.al_trainer - rho 1.000E+00, alpha 0.000E+00
2025-06-06 13:14:28,792 CRITICAL - helpers.log_helper - Unhandled exception
Traceback (most recent call last):
  File "C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\client\session.py", line 1334, in _do_call
    return fn(*args)
  File "C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\client\session.py", line 1319, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\client\session.py", line 1407, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero
	 [[{{node Reshape_2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 404, in <module>
    W_est= main(n=100, p=len(data_array_fmri), data=data_array_fmri_data_temp, W=data_array_fmri)
  File "main.py", line 249, in main
    args.max_iter, args.iter_step, output_dir)
  File "C:\code_old\code\python\PC_Linear_Ancestral_experiment_4\GAE\src\trainers\al_trainer.py", line 52, in train
    loss_new, mse_new, h_new, W_new = self.train_step(model, iter_step, X, rho, alpha)
  File "C:\code_old\code\python\PC_Linear_Ancestral_experiment_4\GAE\src\trainers\al_trainer.py", line 94, in train_step
    model.lr: self.learning_rate})
  File "C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\client\session.py", line 929, in run
    run_metadata_ptr)
  File "C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\client\session.py", line 1152, in _run
    feed_dict_tensor, options, run_metadata)
  File "C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\client\session.py", line 1328, in _do_run
    run_metadata)
  File "C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\client\session.py", line 1348, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero
	 [[node Reshape_2 (defined at C:\code_old\code\python\PC_Linear_Ancestral_experiment_4\GAE\src\models\gae.py:101) ]]

Caused by op 'Reshape_2', defined at:
  File "main.py", line 404, in <module>
    W_est= main(n=100, p=len(data_array_fmri), data=data_array_fmri_data_temp, W=data_array_fmri)
  File "main.py", line 242, in main
    args.hidden_size, 0, args.l1_graph_penalty, args.use_float64)
  File "C:\code_old\code\python\PC_Linear_Ancestral_experiment_4\GAE\src\models\gae.py", line 31, in __init__
    self._build()
  File "C:\code_old\code\python\PC_Linear_Ancestral_experiment_4\GAE\src\models\gae.py", line 65, in _build
    self.mse_loss = self._get_mse_loss(self.X, self.W_prime)
  File "C:\code_old\code\python\PC_Linear_Ancestral_experiment_4\GAE\src\models\gae.py", line 83, in _get_mse_loss
    X_prime = self._decoder_forward(X_prime)
  File "C:\code_old\code\python\PC_Linear_Ancestral_experiment_4\GAE\src\models\gae.py", line 95, in _decoder_forward
    output_dim=self.x_dim)
  File "C:\code_old\code\python\PC_Linear_Ancestral_experiment_4\GAE\src\models\gae.py", line 101, in _flatten_forward
    flatten = tf.reshape(x, shape=(-1, input_dim))
  File "C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\ops\gen_array_ops.py", line 8461, in reshape
    "Reshape", tensor=tensor, shape=shape, name=name)
  File "C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\util\deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\framework\ops.py", line 3300, in create_op
    op_def=op_def)
  File "C:\Program_Files\anaconda3\envs\py37\lib\site-packages\tensorflow\python\framework\ops.py", line 1801, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero
	 [[node Reshape_2 (defined at C:\code_old\code\python\PC_Linear_Ancestral_experiment_4\GAE\src\models\gae.py:101) ]]

